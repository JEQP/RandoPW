<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <title>Where are you?</title>
</head>

<style>
  textarea {
    border-style: dashed;
    width: 100%;
    height: 5em;
  }

  .btn-danger {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 13px;
    color: white;
    letter-spacing: 1px;
    line-height: 15px;
    border: 2px solid #af0808;
    border-radius: 40px;
    background: #af0808;
    ;
    transition: all 0.3s ease 0s;
  }

  .btn-basic {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 13px;
    color: white;
    letter-spacing: 1px;
    line-height: 15px;
    border: 2px solid #c7c0cf;
    border-radius: 40px;
    background: #c7c0cf;
    transition: all 0.3s ease 0s;
  }
</style>

<body>
  <div class="container.fluid bg-light">
    <!-- Sexy front page with Title, brief instructions, buttons to respond to events, and output box -->
    <!-- large container with background colour #f7f3f3 "whitesmoke" -->
    <header>
      <h1 class="text-center">Password Generator</h1>
    </header>
    <!-- Container with background colour white -->
    <div class="container bg-white">
      <!-- See if you can make this shadowed <div class="container shadow p-3 mb-5 bg-white rounded">  -->
      <h2>Generate a Password</h2>
      <!-- line between here and box -->
      <hr>
      <!-- text area 90% width of parent box. Dashed border. Height 5 lines, however that is measured -->
      <textarea readonly id="password" placeholder="Your Secure Password" aria-label="Generated Password"
        class="rounded text-center"></textarea>
      <!-- line between box and buttons -->
      <hr>
      <!-- buttons in a row...generate is "danger", copy is "basic", buttons are large, add border-radius:50% or 12px -->
      <div class="row">
        <div class="col-sm-6">
          <button id="generate" class="btn btn-danger btn-large" onclick="generatePassword()">Generate A
            Password</button>
        </div>
        <div class="col-sm-6 text-right">
          <button id="copy" class="btn btn-basic btn-large" onClick="copy2Clipboard()">Copy to Clipboard</button>
        </div>
      </div>

    </div>
  </div>

  <script>
    // create global variables
    var currentCharChoice = [];
    var lowerCaseChars = ["q", "w", "e", "r", "t", "y", "u", "i", "o", "p", "l", "k", "j", "h", "g", "f", "d", "s", "a", "z", "x", "c", "v", "b", "n", "m"];
    var upperCaseChars = ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P", "L", "K", "J", "H", "G", "F", "D", "S", "A", "Z", "X", "C", "V", "B", "N", "M"];
    var numericalChars = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0];
    var specialChars = ["~", "!", "@", "#", "$", "%", "^", "&", "*", "(", ")", "{", "}", "[", "]", ":", ";", "<", ">", "?", "/", "+", ".", ",", "|"];
    var newPassword = "";


    function generatePassword() {
      // Prompt for number of chars of password -- check that it is a number, and between the required values
      var passwordLengthString = prompt("Enter the desired length of password, from 8 to 128 characters.");
      var passwordLengthNumber = parseInt(passwordLengthString);


      // NOTE: If if the prompt is not a number, or left empty, parseInt will return 0, which is less than 8 and so will be treated as invalid.
      if (passwordLengthNumber > 7 && passwordLengthNumber < 129) {
        // Prompt for lowercase characters
        var LCBool = confirm("Do you want the password to contain lowercase letters?");
        // If yes, add lowerCaseChars array to currentCharChoice array
        if (LCBool) {
          currentCharChoice = currentCharChoice.concat(lowerCaseChars);
        }

        // Prompt for uppercase characters
        var UCBool = confirm("Do you want the password to contain uppercase letters?");
        // If yes, add upperCaseChars array to currentCharChoice array
        if (UCBool) {
          currentCharChoice = currentCharChoice.concat(upperCaseChars);
        }

        // Prompt for numerical characters
        var numBool = confirm("Do you want numbers in your password?");
        // If yes, add numericalChars to currentCharChoice array
        if (numBool) {
          currentCharChoice = currentCharChoice.concat(numericalChars);
        }

        // Prompot for special characters
        var specBool = confirm("Do you want special characters in your password?");
        // If yes, add specialChars to currentCharChoice array
        if (specBool) {
          currentCharChoice = currentCharChoice.concat(specialChars);
        }

        for (var i = 0; i < currentCharChoice.length; i++) {
          console.log(currentCharChoice[i]);
        }

        // check that the users accepted at least one of these inputs

        if (currentCharChoice.length > 1) {
          // Generate random numbers between 0 and 255 in an array (including zero and 255)
          var randomArray = new Uint8Array(passwordLengthNumber);
          window.crypto.getRandomValues(randomArray);

          for (var i = 0; i < randomArray.length; i++) {
            // match number in each element of randomArray to character in each element of currentCharChoiceArray
            // console.log("randomarray =" + randomArray[i]);
            var x = (randomArray[i] / 256);
            x = x * currentCharChoice.length;
            x = Math.floor(x);
            document.getElementById("password").innerHTML = x;
            // console.log("x = " + x);
            // console.log(currentCharChoice[x]);
            // This adds each new character to the string newPassword
            newPassword = newPassword.concat(currentCharChoice[x]);
            // console.log(newPassword);

          }

          // Prints new password in #password
          document.getElementById("password").innerHTML = newPassword;

        }

        else {
          alert("You have to pick at least one type of character for a password to be generated.")
        }

      }
      else {
        alert("That's not a valid response, sorry.")
      }
    }


    // Copies the text in the password textarea box to the clipboard.
    function copy2Clipboard() {
      var copyText = document.getElementById("password");

      /* Select the text field */
      copyText.select();
      copyText.setSelectionRange(0, 99999); /*For mobile devices*/

      /* Copy the text inside the text field */
      document.execCommand("copy");

      /* Alert the copied text */
      alert("The password has been copied to your clipboard.");

    }


    // Prompt to include special chars -- boolean

    // Prompt to include numerical chars -- boolean

    // Generate random password

    // Generate random number. This method is reported to be random in the cryptographic sense, that is more random than math.random
    //  Uint8Array is an array of 8 bits per element. It holds numbers from 0 to 255
    // var randomArray = new Uint8Array(128);
    // window.crypto.getRandomValues(randomArray);

    // console.log("Your lucky numbers:");
    // for (var i = 0; i < randomArray.length; i++) {
    //   console.log(randomArray[i]);

    // }

// Revised criteria: The user can choose to include any and all of four different character types: lowercase letters, uppercase letters, numbers, special characters. 
// That would require 24 different arrays using the previous method, which is untenable. 
// Hard-code 4 arrays with each different type of character. Creat currentCharChoice, a zero-length array. As the user chooses characters, concatenate currentCharChoice with the appropriate arrays.
// generate a random array of the required size of the password
// take the number in the element at each position of the randomArray, and map that to a position in the content array, output that content
// NOTE: The number in randomArray may be larger than the size of the contentArray. Figure out a fix.
// Output each char onto screen as they're produced, to concatenate them into a string and then print that


// output random password

  </script>

</body>

</html>